# 📱 Пример ответа бота

## Как это работает

1. Пользователь открывает WebApp через кнопку `/webapp`
2. Заполняет форму с параметрами генерации
3. Нажимает кнопку "🎨 Сгенерировать"
4. WebApp отправляет данные боту
5. Бот показывает красивый ответ с параметрами

## 📋 Пример ответа бота

После отправки данных из WebApp, бот отвечает:

```
✅ Данные успешно получены из WebApp!

━━━━━━━━━━━━━━━━━━━━━━
📋 ПАРАМЕТРЫ ГЕНЕРАЦИИ:
━━━━━━━━━━━━━━━━━━━━━━

📝 Промпт:
   beautiful landscape, mountains, sunset, detailed

🤖 Модель: stable-diffusion-xl
🖼️ Количество изображений: 2
🔄 Steps (качество): 30
⚖️ CFG Scale (точность): 7.0
📐 Размер: 768x768

━━━━━━━━━━━━━━━━━━━━━━

⏳ Генерирую 2 изображения...
Пожалуйста, подождите...
```

Затем бот отправляет сгенерированные изображения (placeholder):

```
[Изображение 1]
✨ Вариант 1/2
Промпт: beautiful landscape, mountains, sunset, detailed

[Изображение 2]
✨ Вариант 2/2
Промпт: beautiful landscape, mountains, sunset, detailed

✅ Генерация завершена!

💡 Используйте /webapp для новой генерации с другими параметрами.
```

## 🎨 Визуализация процесса

```
Пользователь:
   ↓
[Нажимает /webapp]
   ↓
Бот отправляет кнопку:
┌─────────────────────────────────┐
│ 🎨 Настройка параметров         │
│                                 │
│ Нажмите кнопку ниже:            │
│                                 │
│ [ ⚙️ Открыть настройки генерации ] │
└─────────────────────────────────┘
   ↓
[Пользователь нажимает кнопку]
   ↓
Открывается WebApp внутри Telegram:
┌─────────────────────────────────┐
│ 🎨 Настройки генерации          │
│                                 │
│ 📝 Промпт:                      │
│ [beautiful landscape, sunset]   │
│                                 │
│ 🤖 Модель:                      │
│ [Stable Diffusion XL ▼]        │
│                                 │
│ 🖼️ Количество: [2 ═══════]     │
│ 🔄 Steps: [30 ════════════]    │
│ ⚖️ CFG Scale: [7.0 ═══════]    │
│                                 │
│ 📐 Размер: [768x768 ▼]         │
│                                 │
│ [    🎨 Сгенерировать    ]      │
└─────────────────────────────────┘
   ↓
[Пользователь нажимает "Сгенерировать"]
   ↓
WebApp отправляет JSON боту:
{
  "prompt": "beautiful landscape, sunset",
  "model": "stable-diffusion-xl",
  "num_images": 2,
  "steps": 30,
  "cfg_scale": 7.0,
  "size": "768x768"
}
   ↓
Бот получает данные и отвечает:
┌─────────────────────────────────┐
│ ✅ Данные успешно получены!     │
│                                 │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│ 📋 ПАРАМЕТРЫ ГЕНЕРАЦИИ:         │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                 │
│ 📝 Промпт:                      │
│    beautiful landscape, sunset  │
│                                 │
│ 🤖 Модель: stable-diffusion-xl  │
│ 🖼️ Количество: 2                │
│ 🔄 Steps: 30                    │
│ ⚖️ CFG Scale: 7.0               │
│ 📐 Размер: 768x768              │
│                                 │
│ ⏳ Генерирую 2 изображения...   │
└─────────────────────────────────┘
   ↓
[Изображение 1 с placeholder]
┌─────────────────────────────────┐
│        [PLACEHOLDER]            │
│    Model: stable-diffusion-xl   │
│    Steps: 30 | CFG: 7.0        │
│                                 │
│ ✨ Вариант 1/2                  │
│ Промпт: beautiful landscape...  │
└─────────────────────────────────┘
   ↓
[Изображение 2 с placeholder]
┌─────────────────────────────────┐
│        [PLACEHOLDER]            │
│    Model: stable-diffusion-xl   │
│    Steps: 30 | CFG: 7.0        │
│                                 │
│ ✨ Вариант 2/2                  │
│ Промпт: beautiful landscape...  │
└─────────────────────────────────┘
   ↓
┌─────────────────────────────────┐
│ ✅ Генерация завершена!         │
│                                 │
│ 💡 Используйте /webapp для      │
│    новой генерации              │
└─────────────────────────────────┘
```

## 📊 Что отображается

### Полученные параметры:

| Параметр | Значение по умолчанию | Описание |
|----------|---------------------|----------|
| **prompt** | "No prompt" | Текст описания изображения |
| **model** | "unknown" | Название модели ИИ |
| **num_images** | 1 | Количество вариантов (1-4) |
| **steps** | 30 | Количество шагов генерации (10-100) |
| **cfg_scale** | 7.0 | Точность следования промпту (1-20) |
| **size** | "768x768" | Размер изображения |

### Формат ответа:

```python
# В коде бота (aiogram):
response_text = (
    "✅ <b>Данные успешно получены из WebApp!</b>\n\n"
    "━━━━━━━━━━━━━━━━━━━━━━\n"
    "📋 <b>ПАРАМЕТРЫ ГЕНЕРАЦИИ:</b>\n"
    "━━━━━━━━━━━━━━━━━━━━━━\n\n"
    f"📝 <b>Промпт:</b>\n"
    f"   <code>{prompt}</code>\n\n"  # <-- Промпт в моноширинном шрифте
    f"🤖 <b>Модель:</b> {model}\n"
    f"🖼️ <b>Количество изображений:</b> {num_images}\n"
    f"🔄 <b>Steps (качество):</b> {steps}\n"
    f"⚖️ <b>CFG Scale (точность):</b> {cfg_scale}\n"
    f"📐 <b>Размер:</b> {size}\n\n"
    "━━━━━━━━━━━━━━━━━━━━━━\n\n"
    f"⏳ Генерирую {num_images} изображения...\n"
    "Пожалуйста, подождите..."
)
```

## 🎯 Преимущества такого отображения

1. **✅ Наглядность** - все параметры видны сразу
2. **📋 Структурированность** - параметры в понятном формате
3. **🎨 Визуальные эмодзи** - легко различать параметры
4. **📝 Подтверждение** - пользователь видит что именно отправил
5. **⏳ Обратная связь** - бот сообщает о начале генерации

## 🔧 Настройка

Вы можете изменить формат ответа в функции `handle_generation_settings`:

### aiogram:
```python
# examples/example_06_mini_apps/aiogram/bot.py
# Строки 207-241
```

### python-telegram-bot:
```python
# examples/example_06_mini_apps/python_telegram_bot/bot.py
# Строки 200-239
```

## 💡 Дополнительные возможности

Можно добавить:

1. **Валидацию параметров**:
```python
if steps < 10 or steps > 100:
    await message.answer("❌ Steps должны быть от 10 до 100!")
    return
```

2. **Сохранение истории**:
```python
# Сохранить в базу данных
await db.save_generation_request(user_id, settings)
```

3. **Статистику использования**:
```python
# Подсчет популярных моделей
most_used_model = await db.get_most_popular_model()
```

4. **Уведомление об очереди**:
```python
queue_position = await get_queue_position(user_id)
await message.answer(f"📊 Ваша позиция в очереди: {queue_position}")
```
